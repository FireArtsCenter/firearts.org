---
import { documentToHtmlString } from '@contentful/rich-text-html-renderer';
import { contentfulClient } from '@/lib/contentful';
import Layout from '@/layouts/Layout.astro';
import PageSection from '@/components/PageSection.astro';
import { type TypeArtistsSkeleton } from '@/types/contentful';

export async function getStaticPaths() {
	const artists = await contentfulClient.getEntries<TypeArtistsSkeleton>({
		content_type: 'artists',
		'fields.role[in]': ['Instructor'],
	});
	console.log({ artists });
	const pages = artists.items
		.filter((item) => Boolean(item.fields.bio)) // if no bio, don't make a page
		.map((item) => ({
			params: {
				slug: item.fields.slug,
			},
			props: {
				name: item.fields.name,
				bio: item.fields.bio
					? documentToHtmlString(item.fields.bio)
					: undefined,
			},
		}));
	return pages;
}

const { name, bio } = Astro.props;
---

<Layout metaData={{}}>
	<PageSection title={`About ${name}`}>
		<div set:html={bio} class='flex flex-col gap-4 text-lg' />
	</PageSection>
</Layout>
